set-option -g update-environment "DBUS_SESSION_BUS_ADDRESS DISPLAY WINDOWID SSH_ASKPASS SSH_AUTH_SOCK SSH_AGENT_PID SSH_CONNECTION XAUTHORITY XDG_SESSION_COOKIE"

# Change the prefix key to ^a -- like GNU Screen.
set-option -g prefix C-a
unbind-key C-b
bind-key C-a send-prefix

setw -g utf8 on
set -g display-time 2000      # status messages display time

set -g display-panes-active-colour red  # Pane selction by superimposed numbers
set -g display-panes-colour green
set -g display-panes-time 4000

set -gs set-clipboard on
setw -g aggressive-resize on
set -g lock-server off      # Sessions lock independently
set -g lock-after-time 1800
# set -g lock-command 'tput civis && zsh -c "read -s -k 1"'
set -g history-limit 10000
set -g default-terminal "xterm-256"
set -g default-shell /usr/bin/zsh

set -g pane-border-fg "#5f0000"
set -g pane-border-bg default
set -g pane-active-border-bg "#8700df"
set -g pane-active-border-fg "#008800"

set -g terminal-overrides '*88col*:colors=88,*256col*:colors=256,rxvt-uni*:XT:Ms=\E]52;%p1%s;%p2%s\007:Cc=\E]12;%p1%s\007:Cr=\E]12;green\007:Cs=\E]777;Cs;%p1%d\007,xterm*:smcup@:rmcup@'
set -g renumber-windows on

unbind-key o
unbind-key A
unbind-key '#'
unbind-key ^x

bind a send-prefix

bind d detach-client

bind l command-prompt "switch-client -t '%%'"

bind ' ' choose-tree

bind S command-prompt "rename-session '%%'"
bind s choose-session

bind c new-window -a
bind "/" command-prompt "find-window '%%'"
bind W command-prompt "rename-window '%%'"
bind w choose-window
bind ^a last-window
bind p previous-window
bind n next-window
bind -n S-Left previous-window
bind -n S-Right next-window
bind "|" split-window -h
bind "-" split-window -v


bind k confirm-before kill-pane
bind . display-panes
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# pane resizing
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5


bind "'" command-prompt -p "SSH: " "new-window -a -n %1 'ssh %1'"

bind t clock-mode

bind ^i display-message
bind ^r refresh-client

bind-key r source-file ~/.tmux.conf \; display-message ".tmux.conf Reloaded"

setw -g automatic-rename on # rename window to reflect current program
set -g renumber-windows on # renumber windows when a window is closed

set -g set-titles on                        # set terminal title
set -g set-titles-string '#h ❐ #S ● #I #W'

# activity
setw -g monitor-activity on
set -g visual-activity off  # Inverts colours. Doesn't produce message
set -g visual-bell off
set -sg escape-time 0

# Status stuff.
set -g status-left-fg yellow
set -g status-left-bg "#5f0000"
set -g status-left-length 70
set -g status-left "#S» #[fg=#005f00]#(whoami)#[fg=#008800]@#[fg=#87ff00]#H#[fg=yellow]::#(~/extIP.sh)"

# Middle status component
set -g status-justify centre
set -g status-utf8 on
set -g status-fg "#111111"
set -g status-bg "#8700df"
setw -g window-status-separator "|"
setw -g window-status-format "#I:#W:#{?window_linked,+#{window_flags},#{window_flags} }"
setw -g window-status-current-format "#[fg=black,bg=#008800]#I:#T@#W:#F"
    # Index:Pane@Window:ActiveFlag

set -g status-right-length 40
set -g status-right-fg yellow
set -g status-right-bg "#5f0000"
set -g status-right '[%a %d/%m %b %H:%M] #{battery_percentage}#{prefix_highlight}'

setw -g mode-bg blue
setw -g mode-fg yellow

# setw -g mouse on
set-option -g mode-mouse on
set-option -g mouse-select-pane on
set-option -g mouse-resize-pane on
set-option -g mouse-select-window on
setw -g mode-keys vi
setw -g mode-fg white

set-window-option -g clock-mode-colour colour69
set-window-option -g clock-mode-style 24

# Sessions
# new -d -smisc -ndstat 'exec dstat -clp --top-bio 5'
new -d -swork -nWindowName
# neww -d -nhmail 'exec mutt -F ~/.muttrc-gmail'
# neww -d -nmusic 'exec ncmpcpp'
# neww -d

# set -t misc lock-after-time 0
# set -t misc:dstat remain-on-exit on

# set -t work:wmail remain-on-exit on
# set -t work:hmail remain-on-exit on
# set -t work:music remain-on-exit on

# # new -d -sirc -nfnirc 'ssh -t n6tadam@xteddy.org tmux a -tirc'
# neww -d -nswirc 'exec weechat'
# neww -d -nfinch 'exec finch'
# #neww -d -nswirc 'exec irssi --home=/home/local/.irssi --config=/home/local/.irssi/config'

# set -t irc:fnirc remain-on-exit on
# set -t irc:swirc remain-on-exit on
# set -t irc:finch remain-on-exit on

# select-window -twork:wmail
# select-window -tirc:fnirc
# select-window -tmisc:dstat

# bind -temacs-copy C-y copy-pipe "xclip -i >/dev/nul"
# bind C-y run -b "tmux save-buffer - | xclip -i"

run-shell ~/Downloads/tmux-battery/battery.tmux
run-shell ~/Downloads/tmux-prefix-highlight/prefix_highlight.tmux
# run-shell ~/Downloads/tmux-copycat/copycat.tmux
run-shell ~/Downloads/tmux-yank/yank.tmux
